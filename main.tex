% -- TODO --
% 1. Adjust footer: 
%   width between footers,
%   Spacing before footers -> have there be a gap but the line continues where the other lines also start
%   Numbering
% -- END --

\documentclass{report}

\usepackage[a4paper, left=2cm, right=2cm, top=2cm, bottom=3.6cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx} % Required for inserting images
\usepackage[most]{tcolorbox}
\tcbuselibrary{listings,minted}
\usepackage{minted}
\usepackage{listings}
\usepackage{xcolor}
%\setlength{\parindent}{0pt} %Globally disable parapgraph indents
\usepackage{fontawesome5} % for the info icon
\usepackage{fancyhdr}
\usepackage{bookmark}
\usepackage{tikz} %gives pixel level controll over things and adds \node \draw
\usetikzlibrary{calc}
\usepackage{titlesec}
\usepackage{lmodern} %to make font sacalable
\usepackage{hyperref} %always load last

% --- Color definitions ---
\definecolor{grayframe}{gray}{0.8}
\definecolor{darkblue}{rgb}{0,0,0.5}
\definecolor{darkgreen}{rgb}{0,0.5,0}
\definecolor{darkred}{rgb}{0.5,0,0}
\definecolor{lightgreen}{rgb}{0.5,0.8,0.5}
\definecolor{lightblue}{RGB}{135 , 210, 250}
\definecolor{orange}{RGB}{252, 202, 40}

% --- Document settings ---
\linespread{1.25} %space between lines
\renewcommand{\textendash}{\rule[0.5ex]{1.2em}{0.5pt}}

% --------------------------------
% --- Header & Footer settings ---
% --------------------------------
\pagestyle{fancy}
\fancyhead{}
\fancyhead[C]{\slshape \leftmark}
\fancyfoot[C]{\textbf{\textendash} \textbf{\thepage} \textbf{\textendash}}
\fancyfoot[R]{ \hspace{1mm} J. A. Schneider}

\fancypagestyle{plain}{
    \fancyhf{} % clear all footer & header fields
    \renewcommand{\headrulewidth}{0pt}
    %\fancyfoot[CE,CO]{\textbf{\textendash} \textbf{\thepage} \textbf{\textendash}}
    \fancyfoot[LO,LE]{J. A. Schneider}
}

% --- Chapter format ---
\titleformat{\chapter}[block] 
  {\normalfont\color{orange}\fontsize{30}{45}\selectfont\bfseries} % title font
  {}               % chapter number
  {0pt}            % space between number and title
  {     \begin{tikzpicture}[remember picture,overlay]
            \node[anchor=north west,inner sep=0pt] at (current page.north west)
                {\includegraphics[width=\paperwidth]{Images/chapter_bg_v3.7}};
        \end{tikzpicture}
   }               % code executed before title
      
\titlespacing*{\chapter}{2.2cm}{1.5cm}{-1cm}

% --- Hook to place TikZ overlay on Header ---
\newcommand{\chapteroverlay}{
  \begin{tikzpicture}[remember picture,overlay]
    \coordinate (chref) at ($(current page.north west) + (2cm,-2cm)$);

    % Big chapter number
    \node[anchor=north west] (chnum) at ($(chref.west)+ (-1em,0em)$)
      {\scalebox{5}{\color{orange} 0\thechapter}};
      
    % "Chapter" label under number
    \node[anchor=north west] (chlabel) at ($(chnum.south west) + (0.4em,-1em)$)
      {\large\color{orange} Chapter};
    
    % Vertical line
    \draw[line width=4pt, color=orange] ($(chref) + (2cm,0)$) -- ++(0,-4.15cm) coordinate (linend);

  \end{tikzpicture}
  \vspace*{1.4cm}
  \newline %we need the new line otherwise text starts on the title line for some reason
}

% --- Hook to place TikZ overlay on Footer ---
\newcommand{\chapterunderlay}{
  \begin{tikzpicture}[remember picture,overlay]
    \coordinate (dhref) at ($(current page.south east) + (-1cm,0cm)$);  
    
    % Footer banner
    \node[anchor=south east] at ($(current page.south east)+ (0.2cm,2.2cm)$ )
      {\includegraphics[scale=1]{Images/footer_v4}};

    % Page number
    \node[anchor=north west] (pgnum) at ($(dhref) + (-4.8cm,3.33cm)$)
      {\fontsize{45}{70}\selectfont \color{yellow!81!red} \textbf\thepage};

    % Vertical line
    \draw[line width=2pt, color=yellow!81!red] ($(dhref) + (-5.2cm,1.6cm)$) -- ++(0.4cm,2cm) coordinate (linend);
  \end{tikzpicture}
}

% ---------------------------
% --- Header & Footer END ---
% ---------------------------

% --- Hyperref customization ---
\hypersetup{
  colorlinks=true,
  linkcolor=black,    % section links
  citecolor=green,  % citations
  urlcolor=blue,  % urls
  backref=page
}

%inject macro file
\input{macros}


\begin{document}


%----------------------
%   Paper Start
%----------------------
\begingroup
\linespread{1}\selectfont
\titleformat{\chapter}[block]{\normalfont\Huge\bfseries}{}{}{}
\titlespacing*{\chapter}{0pt}{0pt}{0pt}
\tableofcontents
\endgroup

%\include*{exampleCodeBlocks}

\include{Chapters/Ch1 - Creation}
\include{Chapters/Ch2 - The Bascis}
\include{Chapters/Ch3 - Working with remotes}
\include{Chapters/Ch4 - Branch Management}
\include{Chapters/Ch5 - Branch Integration}
\include{Chapters/Ch6 - Solving Conflicts}
\include{Chapters/Ch7 - Tracking Path Changes}
\include{Chapters/Ch8 - Git Configurations}

\begingroup
\titleformat{\chapter}[block]{\normalfont\Huge\bfseries}{}{}{}
\titlespacing{\chapter}{0pt}{0pt}{0pt}
\appendix
% \include{Chapters/Appendix A - Command List}
% \include{Chapters/Appendix B - Glossary}
\endgroup
\end{document}

